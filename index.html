<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FRID Challenge</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4834d4;
            --primary-light: #686de0;
            --primary-dark: #30336b;
            --bg-dark: #1a1a2e;
            --bg-darker: #0f0f1a;
            --success: #2ecc71;
            --danger: #e74c3c;
            --warning: #f39c12;
            --text: #ffffff;
            --text-muted: #a0a0c0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg-darker);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .background-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            opacity: 0.03;
            background-image: url('frid.png');
            background-repeat: repeat;
            background-size: 200px;
            pointer-events: none;
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo {
            height: 80px;
            margin-bottom: 20px;
            filter: drop-shadow(0 0 20px rgba(72, 52, 212, 0.5));
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary-light), var(--primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            color: var(--text-muted);
            font-size: 1.1rem;
        }

        .game-tabs {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 30px;
        }

        .tab-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 50px;
            font-family: inherit;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--bg-dark);
            color: var(--text-muted);
            border: 2px solid transparent;
        }

        .tab-btn:hover {
            border-color: var(--primary);
            color: var(--text);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: 0 5px 20px rgba(72, 52, 212, 0.4);
        }

        .game-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .game-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: linear-gradient(145deg, var(--bg-dark), rgba(30, 30, 50, 0.9));
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(72, 52, 212, 0.2);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        /* Typing Game Styles */
        .stats-row {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-box {
            background: rgba(72, 52, 212, 0.1);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(72, 52, 212, 0.2);
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary-light);
        }

        .typing-area {
            margin-bottom: 25px;
        }

        .target-text {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            font-size: 1.2rem;
            line-height: 1.8;
            font-family: 'Courier New', monospace;
            word-wrap: break-word;
        }

        .target-text .correct {
            color: var(--success);
        }

        .target-text .incorrect {
            color: var(--danger);
            background: rgba(231, 76, 60, 0.2);
            border-radius: 3px;
        }

        .target-text .current {
            background: var(--primary);
            color: white;
            border-radius: 3px;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .target-text .pending {
            color: var(--text-muted);
        }

        .typing-input {
            width: 100%;
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid var(--primary);
            border-radius: 12px;
            padding: 15px 20px;
            font-size: 1.1rem;
            color: var(--text);
            font-family: 'Courier New', monospace;
            outline: none;
            transition: all 0.3s ease;
        }

        .typing-input:focus {
            box-shadow: 0 0 20px rgba(72, 52, 212, 0.4);
        }

        .typing-input:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn {
            padding: 15px 40px;
            border: none;
            border-radius: 50px;
            font-family: inherit;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: 0 5px 20px rgba(72, 52, 212, 0.4);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(72, 52, 212, 0.5);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-center {
            display: flex;
            justify-content: center;
        }

        /* Results Modal */
        .results-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 100;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }

        .results-overlay.show {
            display: flex;
        }

        .results-modal {
            background: linear-gradient(145deg, var(--bg-dark), var(--bg-darker));
            border-radius: 25px;
            padding: 40px;
            text-align: center;
            border: 2px solid var(--primary);
            box-shadow: 0 0 60px rgba(72, 52, 212, 0.5);
            max-width: 500px;
            width: 90%;
        }

        .results-modal h2 {
            font-size: 2rem;
            margin-bottom: 30px;
            color: var(--primary-light);
        }

        .results-modal.cheater h2 {
            color: var(--danger);
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 1.2rem;
        }

        .result-item:last-of-type {
            border-bottom: none;
            margin-bottom: 30px;
        }

        .result-label {
            color: var(--text-muted);
        }

        .result-value {
            font-weight: 800;
            color: var(--success);
        }

        .result-value.warning {
            color: var(--warning);
        }

        .result-value.danger {
            color: var(--danger);
        }

        .macro-warning {
            background: rgba(231, 76, 60, 0.2);
            border: 1px solid var(--danger);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 25px;
            color: var(--danger);
        }

        /* Aim Trainer Styles */
        .aim-container {
            position: relative;
            width: 100%;
            height: 500px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            overflow: hidden;
            cursor: crosshair;
            border: 2px solid var(--primary);
        }

        .aim-stats {
            display: flex;
            justify-content: space-around;
            padding: 20px;
            background: rgba(72, 52, 212, 0.1);
            margin-bottom: 20px;
            border-radius: 12px;
        }

        .aim-stat {
            text-align: center;
        }

        .aim-stat-label {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 5px;
        }

        .aim-stat-value {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary-light);
        }

        .aim-target {
            position: absolute;
            width: 120px;
            height: 120px;
            cursor: pointer;
            transition: transform 0.1s ease;
            animation: targetPop 0.2s ease;
            z-index: 10;
            user-select: none;
            -webkit-user-drag: none;
            pointer-events: auto;
        }

        .aim-target:hover {
            transform: scale(1.1);
        }

        @keyframes targetPop {
            from { transform: scale(0); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .aim-start-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 20;
        }

        .aim-start-overlay h3 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--text);
        }

        .aim-start-overlay.hidden {
            display: none;
        }

        .aim-results {
            padding: 30px;
            text-align: center;
        }

        .accuracy-ring {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            border: 8px solid var(--primary);
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto 20px;
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary-light);
        }

        .click-effect {
            position: absolute;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 2px solid var(--danger);
            animation: clickRipple 0.5s ease forwards;
            pointer-events: none;
        }

        @keyframes clickRipple {
            from { transform: scale(0); opacity: 1; }
            to { transform: scale(2); opacity: 0; }
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--primary-light));
            border-radius: 4px;
            transition: width 0.1s linear;
        }

        /* Tile Frenzy Styles */
        .frenzy-container {
            position: relative;
            width: 100%;
            border-radius: 15px;
            overflow: hidden;
            border: 2px solid var(--primary);
        }

        .frenzy-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 8px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.4);
            aspect-ratio: 1;
            max-width: 500px;
            margin: 0 auto;
        }

        .frenzy-cell {
            background: rgba(72, 52, 212, 0.15);
            border-radius: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.15s ease;
            border: 2px solid transparent;
            aspect-ratio: 1;
            user-select: none;
            -webkit-user-select: none;
            -webkit-user-drag: none;
            -webkit-touch-callout: none;
        }

        .frenzy-cell:hover {
            background: rgba(72, 52, 212, 0.25);
            border-color: rgba(72, 52, 212, 0.4);
        }

        .frenzy-cell.active {
            background: rgba(72, 52, 212, 0.3);
            border-color: var(--primary);
            animation: tilePulse 0.5s ease infinite alternate;
        }

        @keyframes tilePulse {
            from { box-shadow: 0 0 10px rgba(72, 52, 212, 0.3); }
            to { box-shadow: 0 0 25px rgba(72, 52, 212, 0.6); }
        }

        .frenzy-cell .frenzy-target {
            width: 80%;
            height: 80%;
            object-fit: contain;
            animation: targetPop 0.15s ease;
            user-select: none;
            -webkit-user-drag: none;
            pointer-events: none;
        }

        .frenzy-cell.hit {
            animation: cellHit 0.3s ease;
        }

        @keyframes cellHit {
            0% { transform: scale(1); background: rgba(46, 204, 113, 0.5); }
            50% { transform: scale(0.9); }
            100% { transform: scale(1); background: rgba(72, 52, 212, 0.15); }
        }

        .combo-popup {
            position: absolute;
            font-size: 2rem;
            font-weight: 800;
            color: var(--warning);
            text-shadow: 0 0 20px rgba(243, 156, 18, 0.8);
            animation: comboFloat 0.8s ease forwards;
            pointer-events: none;
            z-index: 30;
        }

        @keyframes comboFloat {
            from { opacity: 1; transform: translateY(0) scale(1); }
            to { opacity: 0; transform: translateY(-50px) scale(1.5); }
        }

        /* Cisco CLI Styles */
        .cisco-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
        }

        .cisco-task-info, .cisco-timer-box {
            text-align: center;
        }

        .cisco-task-label, .cisco-timer-label {
            display: block;
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 4px;
        }

        .cisco-task-num, .cisco-timer {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary-light);
        }

        .difficulty-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .difficulty-badge.easy {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
            border: 1px solid rgba(46, 204, 113, 0.4);
        }

        .difficulty-badge.medium {
            background: rgba(243, 156, 18, 0.2);
            color: #f39c12;
            border: 1px solid rgba(243, 156, 18, 0.4);
        }

        .difficulty-badge.hard {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.4);
        }

        .cisco-scenario {
            background: rgba(72, 52, 212, 0.1);
            border: 1px solid rgba(72, 52, 212, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .cisco-scenario h3 {
            color: var(--primary-light);
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .cisco-scenario p {
            color: var(--text-muted);
            line-height: 1.6;
        }

        .cisco-terminal {
            background: #0d1117;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid #30363d;
            margin-bottom: 15px;
        }

        .terminal-header {
            background: #161b22;
            padding: 12px 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            border-bottom: 1px solid #30363d;
        }

        .terminal-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .terminal-dot.red { background: #ff5f56; }
        .terminal-dot.yellow { background: #ffbd2e; }
        .terminal-dot.green { background: #27ca40; }

        .terminal-title {
            margin-left: 10px;
            color: #8b949e;
            font-size: 0.85rem;
        }

        .terminal-body {
            padding: 15px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.95rem;
            min-height: 200px;
            max-height: 300px;
            overflow-y: auto;
        }

        .terminal-output {
            margin-bottom: 10px;
        }

        .terminal-output .line {
            margin-bottom: 5px;
            color: #c9d1d9;
        }

        .terminal-output .line.command {
            color: #58a6ff;
        }

        .terminal-output .line.success {
            color: #3fb950;
        }

        .terminal-output .line.error {
            color: #f85149;
        }

        .terminal-output .line.system {
            color: #8b949e;
        }

        .terminal-input-line {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .terminal-prompt {
            color: #3fb950;
            font-weight: 600;
            white-space: nowrap;
        }

        .terminal-input {
            flex: 1;
            background: transparent;
            border: none;
            color: #c9d1d9;
            font-family: inherit;
            font-size: inherit;
            outline: none;
            caret-color: #58a6ff;
        }

        .terminal-input:disabled {
            opacity: 0.5;
        }

        .cisco-hint {
            background: rgba(243, 156, 18, 0.1);
            border: 1px solid rgba(243, 156, 18, 0.3);
            border-radius: 8px;
            padding: 12px 15px;
            color: #f39c12;
            font-size: 0.9rem;
            margin-bottom: 20px;
            display: none;
        }

        .cisco-hint.show {
            display: block;
        }

        .expected-commands {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .expected-commands h4 {
            color: var(--text-muted);
            font-size: 0.85rem;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .expected-commands code {
            display: block;
            background: rgba(72, 52, 212, 0.2);
            padding: 8px 12px;
            border-radius: 6px;
            margin-bottom: 5px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            color: var(--primary-light);
        }

        .expected-commands code:last-child {
            margin-bottom: 0;
        }

        .cisco-answer-reveal {
            display: none;
            margin-bottom: 20px;
        }

        .cisco-answer-reveal.show {
            display: block;
        }

        .info-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 2px solid var(--primary);
            background: rgba(72, 52, 212, 0.2);
            color: var(--primary-light);
            font-size: 1.2rem;
            font-weight: 700;
            font-style: italic;
            font-family: 'Georgia', serif;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .info-btn:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.1);
        }

        .info-btn.clicked {
            background: var(--primary);
            color: white;
        }

        .answer-box {
            display: none;
            margin-top: 15px;
            background: rgba(72, 52, 212, 0.15);
            border: 1px solid rgba(72, 52, 212, 0.3);
            border-radius: 12px;
            padding: 15px 20px;
            animation: fadeIn 0.3s ease;
        }

        .answer-box.show {
            display: block;
        }

        .answer-box h4 {
            color: var(--primary-light);
            font-size: 0.9rem;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .answer-box code {
            display: block;
            background: rgba(0, 0, 0, 0.3);
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 8px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            color: #3fb950;
            font-size: 0.95rem;
        }

        .answer-box code:last-child {
            margin-bottom: 0;
        }

        /* Cisco Match Game Styles */
        .match-header {
            display: flex;
            justify-content: center;
            gap: 40px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .match-stat {
            text-align: center;
        }

        .match-stat-label {
            display: block;
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .match-stat-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary-light);
        }

        .match-instruction {
            text-align: center;
            padding: 15px;
            background: rgba(72, 52, 212, 0.1);
            border-radius: 8px;
            margin-bottom: 20px;
            color: var(--text-muted);
        }

        .match-container {
            display: grid;
            grid-template-columns: 1fr 120px 1fr;
            gap: 10px;
            min-height: 400px;
            position: relative;
        }

        .match-column {
            display: flex;
            flex-direction: column;
        }

        .match-column h4 {
            text-align: center;
            color: var(--primary-light);
            margin-bottom: 15px;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .match-items {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .match-item {
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(72, 52, 212, 0.3);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .match-item:hover:not(.matched):not(.disabled) {
            border-color: var(--primary);
            background: rgba(72, 52, 212, 0.2);
        }

        .match-item.selected {
            border-color: var(--primary);
            background: rgba(72, 52, 212, 0.3);
            box-shadow: 0 0 15px rgba(72, 52, 212, 0.4);
        }

        .match-item.matched {
            border-color: var(--success);
            background: rgba(46, 204, 113, 0.2);
            cursor: default;
        }

        .match-item.error {
            animation: matchError 0.5s ease;
        }

        @keyframes matchError {
            0%, 100% { border-color: var(--danger); background: rgba(231, 76, 60, 0.2); }
            50% { border-color: var(--danger); background: rgba(231, 76, 60, 0.4); }
        }

        .match-item.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .match-item .match-letter {
            position: absolute;
            left: -12px;
            top: 50%;
            transform: translateY(-50%);
            width: 24px;
            height: 24px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
            font-family: 'Outfit', sans-serif;
            color: white;
        }

        .match-item.matched .match-letter {
            background: var(--success);
        }

        .match-lines {
            position: relative;
        }

        #match-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        #match-svg line {
            stroke: var(--success);
            stroke-width: 3;
            stroke-linecap: round;
        }

        .match-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(15, 15, 26, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            z-index: 10;
        }

        .match-overlay.hidden {
            display: none;
        }

        .match-overlay h3 {
            font-size: 1.8rem;
            color: var(--primary-light);
            margin-bottom: 15px;
        }

        .match-overlay p {
            color: var(--text-muted);
            margin-bottom: 25px;
        }

        .match-check {
            color: var(--success);
            margin-left: 10px;
        }

        .match-x {
            color: var(--danger);
            margin-left: 10px;
        }

        /* Windows Setup Styles */
        .windows-card {
            padding: 0;
            overflow: hidden;
        }

        .windows-timer-bar {
            background: rgba(0, 120, 212, 0.2);
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid rgba(0, 120, 212, 0.3);
        }

        .windows-timer-label {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .windows-timer {
            font-size: 1.3rem;
            font-weight: 700;
            color: #0078d4;
        }

        .windows-container {
            height: 550px;
            background: linear-gradient(135deg, #0078d4 0%, #00bcf2 50%, #00b294 100%);
            position: relative;
            overflow: hidden;
        }

        .windows-screen {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #f3f3f3;
            border-radius: 8px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 700px;
            max-height: 90%;
            overflow: hidden;
            font-family: 'Segoe UI', 'Outfit', sans-serif;
            color: #1a1a1a;
        }

        .windows-welcome {
            padding: 60px 40px;
            text-align: center;
        }

        .windows-logo {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .windows-welcome h2 {
            color: #1a1a1a;
            margin-bottom: 15px;
            font-size: 1.8rem;
        }

        .windows-welcome p {
            color: #666;
            margin-bottom: 10px;
        }

        .windows-controls {
            margin: 20px 0 30px;
        }

        .windows-controls kbd {
            background: #e1e1e1;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.85rem;
            margin: 0 3px;
            border: 1px solid #ccc;
            font-family: inherit;
        }

        .windows-btn {
            padding: 12px 32px;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: inherit;
            margin: 5px;
        }

        .windows-btn.primary {
            background: #0078d4;
            color: white;
        }

        .windows-btn.primary:hover, .windows-btn.primary:focus {
            background: #106ebe;
        }

        .windows-btn.primary.focused {
            outline: 3px solid #005a9e;
            outline-offset: 2px;
            background: #005a9e;
            box-shadow: 0 0 10px rgba(0, 120, 212, 0.5);
        }

        .windows-btn.secondary {
            background: #e1e1e1;
            color: #1a1a1a;
        }

        .windows-btn.secondary:hover, .windows-btn.secondary:focus {
            background: #d1d1d1;
        }

        .windows-btn.secondary.focused {
            outline: 3px solid #666;
            outline-offset: 2px;
        }

        .windows-btn.link {
            background: transparent;
            color: #0078d4;
            text-decoration: underline;
            padding: 8px 16px;
        }

        .windows-btn.link:hover {
            color: #106ebe;
        }

        .windows-header {
            padding: 40px 40px 20px;
        }

        .windows-header h2 {
            color: #1a1a1a;
            font-size: 1.6rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .windows-header p {
            color: #666;
            font-size: 0.95rem;
        }

        .windows-content {
            padding: 0 40px 30px;
        }

        .windows-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            max-height: 250px;
            overflow-y: auto;
            padding: 5px;
        }

        .windows-option {
            padding: 15px 20px;
            background: white;
            border: 2px solid #e1e1e1;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.15s ease;
            text-align: left;
        }

        .windows-option:hover {
            border-color: #0078d4;
            background: #f0f8ff;
        }

        .windows-option.selected {
            border-color: #0078d4;
            background: #e6f2ff;
        }

        .windows-option.focused {
            border-color: #0078d4;
            background: #cce4ff;
            outline: 2px solid #0078d4;
            outline-offset: -2px;
        }

        .windows-option.selected.focused {
            background: #b3d7ff;
        }

        .windows-option .option-title {
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 2px;
        }

        .windows-option .option-subtitle {
            font-size: 0.85rem;
            color: #666;
        }

        .windows-footer {
            padding: 20px 40px;
            background: #fafafa;
            border-top: 1px solid #e1e1e1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .windows-footer-right {
            display: flex;
            gap: 10px;
        }

        .windows-checkbox {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px 15px;
            background: white;
            border: 2px solid #e1e1e1;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.15s ease;
            margin-bottom: 10px;
        }

        .windows-checkbox:hover {
            border-color: #0078d4;
        }

        .windows-checkbox.focused {
            border-color: #0078d4;
            background: #f0f8ff;
        }

        .windows-checkbox input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-top: 2px;
            accent-color: #0078d4;
        }

        .windows-checkbox-label {
            flex: 1;
        }

        .windows-checkbox-label .title {
            font-weight: 500;
            color: #1a1a1a;
            margin-bottom: 3px;
        }

        .windows-checkbox-label .desc {
            font-size: 0.85rem;
            color: #666;
        }

        .windows-privacy-scroll {
            max-height: 220px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .windows-privacy-scroll::-webkit-scrollbar {
            width: 8px;
        }

        .windows-privacy-scroll::-webkit-scrollbar-track {
            background: #e1e1e1;
            border-radius: 4px;
        }

        .windows-privacy-scroll::-webkit-scrollbar-thumb {
            background: #0078d4;
            border-radius: 4px;
        }

        .windows-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e1e1;
            border-radius: 6px;
            font-size: 1rem;
            font-family: inherit;
            margin-bottom: 15px;
            transition: border-color 0.2s;
        }

        .windows-input:focus {
            outline: none;
            border-color: #0078d4;
        }

        .windows-progress {
            display: flex;
            justify-content: center;
            gap: 8px;
            padding: 15px;
            background: #fafafa;
            border-top: 1px solid #e1e1e1;
        }

        .windows-progress-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #d1d1d1;
        }

        .windows-progress-dot.active {
            background: #0078d4;
        }

        .windows-progress-dot.completed {
            background: #107c10;
        }

        .windows-loading {
            text-align: center;
            padding: 60px 40px;
        }

        .windows-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #e1e1e1;
            border-top-color: #0078d4;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .stats-row {
                grid-template-columns: repeat(2, 1fr);
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .aim-container {
                height: 400px;
            }
            
            .aim-target {
                width: 90px;
                height: 90px;
            }
            
            .tab-btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
            
            .frenzy-grid {
                gap: 6px;
                padding: 10px;
            }
            
            .frenzy-cell {
                border-radius: 8px;
            }
            
            .cisco-header {
                flex-direction: column;
                gap: 15px;
            }
            
            .terminal-body {
                font-size: 0.85rem;
                min-height: 150px;
            }
            
            .windows-container {
                height: 450px;
            }
            
            .windows-screen {
                padding: 20px;
            }
            
            .windows-options {
                grid-template-columns: 1fr;
            }
            
            .match-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .match-lines {
                display: none;
            }
            
            .match-item {
                font-size: 0.8rem;
                padding: 12px 15px;
            }
        }
    </style>
</head>
<body>
    <div class="background-pattern"></div>
    
    <div class="container">
        <header>
            <img src="frid.png" alt="FRID Logo" class="logo">
            <h1>FRID Challenge Arena</h1>
            <p class="subtitle">Test your typing speed & aim precision!</p>
        </header>

        <div class="game-tabs">
            <button class="tab-btn active" onclick="switchTab('typing')">‚å®Ô∏è Typing Challenge</button>
            <button class="tab-btn" onclick="switchTab('aim')">üéØ Aim Trainer</button>
            <button class="tab-btn" onclick="switchTab('frenzy')">‚ö° Tile Frenzy</button>
            <button class="tab-btn" onclick="switchTab('cisco')">üíª Cisco CLI</button>
            <button class="tab-btn" onclick="switchTab('ciscomatch')">üîó Cisco Match</button>
            <button class="tab-btn" onclick="switchTab('windows')">ü™ü Windows Setup</button>
        </div>

        <!-- Typing Challenge Section -->
        <section id="typing-section" class="game-section active">
            <div class="card">
                <div class="stats-row">
                    <div class="stat-box">
                        <div class="stat-label">Time</div>
                        <div class="stat-value" id="timer">0.0s</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Progress</div>
                        <div class="stat-value" id="progress">0/10</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">WPM</div>
                        <div class="stat-value" id="wpm">0</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Accuracy</div>
                        <div class="stat-value" id="accuracy">100%</div>
                    </div>
                </div>

                <div class="typing-area">
                    <div class="target-text" id="target-display"></div>
                    <input type="text" class="typing-input" id="typing-input" 
                           placeholder="Start typing here..." autocomplete="off" spellcheck="false">
                </div>

                <div class="btn-center">
                    <button class="btn" id="reset-btn" onclick="resetTypingGame()">üîÑ Reset</button>
                </div>
            </div>
        </section>

        <!-- Aim Trainer Section -->
        <section id="aim-section" class="game-section">
            <div class="card">
                <div class="aim-stats">
                    <div class="aim-stat">
                        <div class="aim-stat-label">Time Left</div>
                        <div class="aim-stat-value" id="aim-timer">30s</div>
                    </div>
                    <div class="aim-stat">
                        <div class="aim-stat-label">Hits</div>
                        <div class="aim-stat-value" id="aim-hits">0</div>
                    </div>
                    <div class="aim-stat">
                        <div class="aim-stat-label">Misses</div>
                        <div class="aim-stat-value" id="aim-misses">0</div>
                    </div>
                    <div class="aim-stat">
                        <div class="aim-stat-label">Accuracy</div>
                        <div class="aim-stat-value" id="aim-accuracy">0%</div>
                    </div>
                </div>

                <div class="aim-container" id="aim-container">
                    <div class="aim-start-overlay" id="aim-overlay">
                        <h3>Click to Start!</h3>
                        <p style="color: var(--text-muted); margin-bottom: 20px;">Click FRID logos as fast as you can!</p>
                        <p style="color: var(--text-muted); font-size: 0.85rem; margin-bottom: 20px;">Press <kbd style="background: var(--bg-darker); padding: 3px 8px; border-radius: 4px;">R</kbd> to restart during game</p>
                        <button class="btn" onclick="startAimGame()">üéØ Start Game</button>
                    </div>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" id="aim-progress" style="width: 100%"></div>
                </div>
            </div>
        </section>

        <!-- Tile Frenzy Section -->
        <section id="frenzy-section" class="game-section">
            <div class="card">
                <div class="aim-stats">
                    <div class="aim-stat">
                        <div class="aim-stat-label">Time Left</div>
                        <div class="aim-stat-value" id="frenzy-timer">30s</div>
                    </div>
                    <div class="aim-stat">
                        <div class="aim-stat-label">Score</div>
                        <div class="aim-stat-value" id="frenzy-score">0</div>
                    </div>
                    <div class="aim-stat">
                        <div class="aim-stat-label">Combo</div>
                        <div class="aim-stat-value" id="frenzy-combo">x1</div>
                    </div>
                    <div class="aim-stat">
                        <div class="aim-stat-label">Best Combo</div>
                        <div class="aim-stat-value" id="frenzy-best">x1</div>
                    </div>
                </div>

                <div class="frenzy-container" id="frenzy-container">
                    <div class="frenzy-grid" id="frenzy-grid">
                        <div class="frenzy-cell" data-index="0"></div>
                        <div class="frenzy-cell" data-index="1"></div>
                        <div class="frenzy-cell" data-index="2"></div>
                        <div class="frenzy-cell" data-index="3"></div>
                        <div class="frenzy-cell" data-index="4"></div>
                        <div class="frenzy-cell" data-index="5"></div>
                        <div class="frenzy-cell" data-index="6"></div>
                        <div class="frenzy-cell" data-index="7"></div>
                        <div class="frenzy-cell" data-index="8"></div>
                    </div>
                    <div class="aim-start-overlay" id="frenzy-overlay">
                        <h3>‚ö° Tile Frenzy!</h3>
                        <p style="color: var(--text-muted); margin-bottom: 20px;">4 tiles appear at once - click them fast!</p>
                        <p style="color: var(--text-muted); font-size: 0.85rem; margin-bottom: 20px;">Press <kbd style="background: var(--bg-darker); padding: 3px 8px; border-radius: 4px;">R</kbd> to restart during game</p>
                        <button class="btn" onclick="startFrenzyGame()">‚ö° Start Frenzy</button>
                    </div>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" id="frenzy-progress" style="width: 100%"></div>
                </div>
            </div>
        </section>

        <!-- Cisco CLI Section -->
        <section id="cisco-section" class="game-section">
            <div class="card">
                <div class="cisco-header">
                    <div class="cisco-task-info">
                        <span class="cisco-task-label">Task</span>
                        <span class="cisco-task-num" id="cisco-task-num">1/5</span>
                    </div>
                    <div class="cisco-difficulty" id="cisco-difficulty">
                        <span class="difficulty-badge easy">EASY</span>
                    </div>
                    <div class="cisco-timer-box">
                        <span class="cisco-timer-label">Time</span>
                        <span class="cisco-timer" id="cisco-timer">0.0s</span>
                    </div>
                </div>

                <div class="cisco-challenge" id="cisco-challenge">
                    <div class="cisco-scenario">
                        <h3 id="cisco-title">Welcome to Cisco CLI Challenge!</h3>
                        <p id="cisco-description">Test your networking skills with 5 challenges from easy to hard. Type the correct Cisco IOS commands to complete each task.</p>
                    </div>
                    
                    <div class="cisco-terminal" id="cisco-terminal">
                        <div class="terminal-header">
                            <span class="terminal-dot red"></span>
                            <span class="terminal-dot yellow"></span>
                            <span class="terminal-dot green"></span>
                            <span class="terminal-title">Cisco IOS Terminal</span>
                        </div>
                        <div class="terminal-body" id="terminal-body">
                            <div class="terminal-output" id="terminal-output"></div>
                            <div class="terminal-input-line">
                                <span class="terminal-prompt" id="terminal-prompt">Router></span>
                                <input type="text" class="terminal-input" id="cisco-input" 
                                       placeholder="Type command here..." autocomplete="off" spellcheck="false" disabled>
                            </div>
                        </div>
                    </div>

                    <div class="cisco-hint" id="cisco-hint"></div>
                    
                    <div class="cisco-answer-reveal" id="cisco-answer-reveal">
                        <button class="info-btn" id="info-btn" onclick="revealAnswer()" title="Show Answer">
                            <span>i</span>
                        </button>
                        <div class="answer-box" id="answer-box">
                            <h4>Expected Commands:</h4>
                            <div id="answer-commands"></div>
                        </div>
                    </div>
                </div>

                <div class="btn-center">
                    <button class="btn" id="cisco-start-btn" onclick="startCiscoGame()">üöÄ Start Challenge</button>
                </div>
            </div>
        </section>

        <!-- Cisco Match Section -->
        <section id="ciscomatch-section" class="game-section">
            <div class="card">
                <div class="match-header">
                    <div class="match-stat">
                        <span class="match-stat-label">Time</span>
                        <span class="match-stat-value" id="match-timer">0.0s</span>
                    </div>
                    <div class="match-stat">
                        <span class="match-stat-label">Matched</span>
                        <span class="match-stat-value" id="match-count">0/6</span>
                    </div>
                    <div class="match-stat">
                        <span class="match-stat-label">Errors</span>
                        <span class="match-stat-value" id="match-errors">0</span>
                    </div>
                </div>

                <div class="match-instruction">
                    <p>Match the command with the device mode at which the command is entered.</p>
                </div>

                <div class="match-container" id="match-container">
                    <div class="match-column">
                        <h4>Commands</h4>
                        <div class="match-items" id="match-commands"></div>
                    </div>
                    
                    <div class="match-lines">
                        <svg id="match-svg" width="100%" height="100%"></svg>
                    </div>
                    
                    <div class="match-column">
                        <h4>Device Modes</h4>
                        <div class="match-items" id="match-modes"></div>
                    </div>
                </div>

                <div class="match-overlay" id="match-overlay">
                    <h3>üîó Cisco Command Matching</h3>
                    <p>Click a command, then click the matching device mode!</p>
                    <button class="btn" onclick="startMatchGame()">Start Matching</button>
                </div>
            </div>
        </section>

        <!-- Windows Setup Section -->
        <section id="windows-section" class="game-section">
            <div class="card windows-card">
                <div class="windows-timer-bar">
                    <span class="windows-timer-label">‚è±Ô∏è Time:</span>
                    <span class="windows-timer" id="windows-timer">0.0s</span>
                </div>

                <div class="windows-container" id="windows-container">
                    <div class="windows-screen" id="windows-screen">
                        <!-- Windows setup screens will be rendered here -->
                        <div class="windows-welcome">
                            <div class="windows-logo">ü™ü</div>
                            <h2>Windows 11 Setup Speedrun</h2>
                            <p>Navigate through the Windows setup as fast as possible!</p>
                            <p class="windows-controls">Use <kbd>Tab</kbd> <kbd>Enter</kbd> <kbd>‚Üë</kbd> <kbd>‚Üì</kbd> or Mouse</p>
                            <button class="windows-btn primary" onclick="startWindowsGame()">Start Setup</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Results Modal -->
    <div class="results-overlay" id="results-overlay">
        <div class="results-modal" id="results-modal">
            <h2 id="results-title">üéâ Challenge Complete!</h2>
            <div id="results-content"></div>
            <button class="btn" onclick="closeResults()">Try Again</button>
        </div>
    </div>

    <script>
        // ============ TYPING GAME ============
        const TARGET_PHRASE = "jeg elsker topdesk";
        const REQUIRED_REPS = 10;
        const fullTarget = (TARGET_PHRASE + " ").repeat(REQUIRED_REPS).trim();
        
        let typingStarted = false;
        let startTime = null;
        let timerInterval = null;
        let currentIndex = 0;
        let correctChars = 0;
        let totalTyped = 0;
        let completedReps = 0;
        let keystrokeTimings = [];
        let lastKeystrokeTime = null;

        const typingInput = document.getElementById('typing-input');
        const targetDisplay = document.getElementById('target-display');
        const timerEl = document.getElementById('timer');
        const progressEl = document.getElementById('progress');
        const wpmEl = document.getElementById('wpm');
        const accuracyEl = document.getElementById('accuracy');

        function initTypingGame() {
            renderTargetText();
            typingInput.value = '';
            typingInput.disabled = false;
            typingInput.focus();
        }

        function renderTargetText() {
            let html = '';
            for (let i = 0; i < fullTarget.length; i++) {
                let char = fullTarget[i];
                let className = 'pending';
                
                if (i < currentIndex) {
                    className = typingInput.value[i] === char ? 'correct' : 'incorrect';
                } else if (i === currentIndex) {
                    className = 'current';
                }
                
                if (char === ' ') {
                    html += `<span class="${className}">&nbsp;</span>`;
                } else {
                    html += `<span class="${className}">${char}</span>`;
                }
            }
            targetDisplay.innerHTML = html;
        }

        // Prevent pasting and dropping text
        typingInput.addEventListener('paste', (e) => {
            e.preventDefault();
        });
        
        typingInput.addEventListener('drop', (e) => {
            e.preventDefault();
        });

        typingInput.addEventListener('input', (e) => {
            const typed = e.target.value;
            const now = Date.now();
            
            // Start timer on first keystroke
            if (!typingStarted && typed.length > 0) {
                typingStarted = true;
                startTime = now;
                lastKeystrokeTime = now;
                timerInterval = setInterval(updateTimer, 100);
            }
            
            // Record keystroke timing for macro detection
            if (lastKeystrokeTime && typingStarted) {
                const interval = now - lastKeystrokeTime;
                keystrokeTimings.push(interval);
            }
            lastKeystrokeTime = now;
            
            currentIndex = typed.length;
            totalTyped = typed.length;
            
            // Count correct characters
            correctChars = 0;
            for (let i = 0; i < typed.length; i++) {
                if (typed[i] === fullTarget[i]) {
                    correctChars++;
                }
            }
            
            // Calculate completed reps
            const phraseWithSpace = TARGET_PHRASE + " ";
            completedReps = Math.floor(currentIndex / phraseWithSpace.length);
            if (currentIndex === fullTarget.length && typed === fullTarget) {
                completedReps = REQUIRED_REPS;
            }
            
            // Update display
            renderTargetText();
            updateStats();
            
            // Check completion
            if (currentIndex >= fullTarget.length) {
                completeTypingGame();
            }
        });

        function updateTimer() {
            if (startTime) {
                const elapsed = (Date.now() - startTime) / 1000;
                timerEl.textContent = elapsed.toFixed(1) + 's';
            }
        }

        function updateStats() {
            progressEl.textContent = `${completedReps}/${REQUIRED_REPS}`;
            
            // Calculate WPM (words = characters / 5)
            if (startTime) {
                const elapsed = (Date.now() - startTime) / 1000 / 60; // minutes
                const words = correctChars / 5;
                const wpm = elapsed > 0 ? Math.round(words / elapsed) : 0;
                wpmEl.textContent = wpm;
            }
            
            // Calculate accuracy
            const accuracy = totalTyped > 0 ? Math.round((correctChars / totalTyped) * 100) : 100;
            accuracyEl.textContent = accuracy + '%';
        }

        function detectMacro() {
            if (keystrokeTimings.length < 20) return { isMacro: false, confidence: 0 };
            
            // Remove first few timings (warm-up)
            const timings = keystrokeTimings.slice(5);
            
            // Calculate standard deviation
            const avg = timings.reduce((a, b) => a + b, 0) / timings.length;
            const variance = timings.reduce((sum, t) => sum + Math.pow(t - avg, 2), 0) / timings.length;
            const stdDev = Math.sqrt(variance);
            
            // Calculate coefficient of variation (CV)
            const cv = (stdDev / avg) * 100;
            
            // Check for suspiciously consistent timing
            // Human typing typically has CV > 15-20%
            // Macros often have CV < 5%
            const isSuspiciouslyConsistent = cv < 8;
            
            // Check for impossibly fast typing (< 30ms between keystrokes consistently)
            const tooFastCount = timings.filter(t => t < 30).length;
            const tooFastPercentage = (tooFastCount / timings.length) * 100;
            
            // Check for exact same intervals (very suspicious)
            const uniqueTimings = new Set(timings.map(t => Math.round(t / 5) * 5));
            const uniquenessRatio = uniqueTimings.size / timings.length;
            
            let confidence = 0;
            let reasons = [];
            
            if (isSuspiciouslyConsistent) {
                confidence += 40;
                reasons.push(`Timing too consistent (CV: ${cv.toFixed(1)}%)`);
            }
            
            if (tooFastPercentage > 50) {
                confidence += 30;
                reasons.push(`${tooFastPercentage.toFixed(0)}% keystrokes under 30ms`);
            }
            
            if (uniquenessRatio < 0.3) {
                confidence += 30;
                reasons.push(`Only ${uniqueTimings.size} unique timing patterns`);
            }
            
            // Super fast completion (< 15 seconds for all 10 reps is nearly impossible)
            const totalTime = (Date.now() - startTime) / 1000;
            if (totalTime < 15) {
                confidence += 30;
                reasons.push(`Completed in ${totalTime.toFixed(1)}s (impossibly fast)`);
            }
            
            return {
                isMacro: confidence >= 50,
                confidence: Math.min(confidence, 100),
                reasons,
                stats: {
                    avgInterval: avg.toFixed(1),
                    stdDev: stdDev.toFixed(1),
                    cv: cv.toFixed(1)
                }
            };
        }

        function completeTypingGame() {
            clearInterval(timerInterval);
            typingInput.disabled = true;
            
            const finalTime = ((Date.now() - startTime) / 1000).toFixed(2);
            const finalWPM = wpmEl.textContent;
            const finalAccuracy = accuracyEl.textContent;
            
            const macroCheck = detectMacro();
            
            const modal = document.getElementById('results-modal');
            const resultsContent = document.getElementById('results-content');
            const resultsTitle = document.getElementById('results-title');
            
            if (macroCheck.isMacro) {
                modal.classList.add('cheater');
                resultsTitle.textContent = 'üö® Macro Detected!';
                resultsContent.innerHTML = `
                    <div class="macro-warning">
                        <strong>‚ö†Ô∏è Suspicious activity detected!</strong><br>
                        Confidence: ${macroCheck.confidence}%<br>
                        ${macroCheck.reasons.join('<br>')}
                    </div>
                    <div class="result-item">
                        <span class="result-label">Time</span>
                        <span class="result-value danger">${finalTime}s</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">WPM</span>
                        <span class="result-value danger">${finalWPM}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Status</span>
                        <span class="result-value danger">DISQUALIFIED</span>
                    </div>
                `;
            } else {
                modal.classList.remove('cheater');
                resultsTitle.textContent = 'üéâ Challenge Complete!';
                resultsContent.innerHTML = `
                    <div class="result-item">
                        <span class="result-label">Final Time</span>
                        <span class="result-value">${finalTime}s</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">WPM</span>
                        <span class="result-value">${finalWPM}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Accuracy</span>
                        <span class="result-value">${finalAccuracy}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Status</span>
                        <span class="result-value">‚úÖ LEGITIMATE</span>
                    </div>
                `;
            }
            
            document.getElementById('results-overlay').classList.add('show');
        }

        function resetTypingGame() {
            clearInterval(timerInterval);
            typingStarted = false;
            startTime = null;
            currentIndex = 0;
            correctChars = 0;
            totalTyped = 0;
            completedReps = 0;
            keystrokeTimings = [];
            lastKeystrokeTime = null;
            
            timerEl.textContent = '0.0s';
            progressEl.textContent = '0/10';
            wpmEl.textContent = '0';
            accuracyEl.textContent = '100%';
            
            initTypingGame();
        }

        // ============ AIM TRAINER ============
        let aimGameActive = false;
        let aimStartTime = null;
        let aimTimerInterval = null;
        let aimHits = 0;
        let aimMisses = 0;
        let currentTarget = null;
        const AIM_DURATION = 30000; // 30 seconds

        const aimContainer = document.getElementById('aim-container');
        const aimOverlay = document.getElementById('aim-overlay');
        const aimTimerEl = document.getElementById('aim-timer');
        const aimHitsEl = document.getElementById('aim-hits');
        const aimMissesEl = document.getElementById('aim-misses');
        const aimAccuracyEl = document.getElementById('aim-accuracy');
        const aimProgressEl = document.getElementById('aim-progress');

        function startAimGame() {
            aimGameActive = true;
            aimStartTime = Date.now();
            aimHits = 0;
            aimMisses = 0;
            
            aimOverlay.classList.add('hidden');
            updateAimStats();
            
            spawnTarget();
            
            aimTimerInterval = setInterval(() => {
                const elapsed = Date.now() - aimStartTime;
                const remaining = Math.max(0, AIM_DURATION - elapsed);
                const seconds = Math.ceil(remaining / 1000);
                
                aimTimerEl.textContent = seconds + 's';
                aimProgressEl.style.width = ((remaining / AIM_DURATION) * 100) + '%';
                
                if (remaining <= 0) {
                    endAimGame();
                }
            }, 100);
            
            // Add click listener for misses
            aimContainer.addEventListener('click', handleMiss);
        }

        function spawnTarget() {
            if (!aimGameActive) return;
            
            // Remove existing target
            if (currentTarget) {
                currentTarget.remove();
            }
            
            const target = document.createElement('img');
            target.src = 'frid.png';
            target.className = 'aim-target';
            target.draggable = false;
            
            // Random position
            const containerRect = aimContainer.getBoundingClientRect();
            const maxX = containerRect.width - 120;
            const maxY = containerRect.height - 120;
            
            target.style.left = Math.random() * maxX + 'px';
            target.style.top = Math.random() * maxY + 'px';
            
            target.addEventListener('click', (e) => {
                e.stopPropagation();
                handleHit(e);
            });
            
            // Prevent dragging
            target.addEventListener('dragstart', (e) => {
                e.preventDefault();
            });
            
            target.addEventListener('mousedown', (e) => {
                e.preventDefault();
            });
            
            aimContainer.appendChild(target);
            currentTarget = target;
        }

        function handleHit(e) {
            if (!aimGameActive) return;
            
            aimHits++;
            updateAimStats();
            
            // Visual feedback
            createClickEffect(e.clientX, e.clientY, true);
            
            spawnTarget();
        }

        function handleMiss(e) {
            if (!aimGameActive) return;
            if (e.target.classList.contains('aim-target')) return;
            if (e.target.classList.contains('btn')) return;
            
            aimMisses++;
            updateAimStats();
            
            // Visual feedback
            createClickEffect(e.clientX, e.clientY, false);
        }

        function createClickEffect(x, y, isHit) {
            const effect = document.createElement('div');
            effect.className = 'click-effect';
            effect.style.left = x - 15 + 'px';
            effect.style.top = y - 15 + 'px';
            effect.style.borderColor = isHit ? 'var(--success)' : 'var(--danger)';
            effect.style.position = 'fixed';
            document.body.appendChild(effect);
            
            setTimeout(() => effect.remove(), 500);
        }

        function updateAimStats() {
            aimHitsEl.textContent = aimHits;
            aimMissesEl.textContent = aimMisses;
            
            const total = aimHits + aimMisses;
            const accuracy = total > 0 ? Math.round((aimHits / total) * 100) : 0;
            aimAccuracyEl.textContent = accuracy + '%';
        }

        function endAimGame() {
            aimGameActive = false;
            clearInterval(aimTimerInterval);
            
            if (currentTarget) {
                currentTarget.remove();
                currentTarget = null;
            }
            
            aimContainer.removeEventListener('click', handleMiss);
            
            const total = aimHits + aimMisses;
            const accuracy = total > 0 ? Math.round((aimHits / total) * 100) : 0;
            
            const modal = document.getElementById('results-modal');
            const resultsContent = document.getElementById('results-content');
            const resultsTitle = document.getElementById('results-title');
            
            modal.classList.remove('cheater');
            resultsTitle.textContent = 'üéØ Aim Training Complete!';
            
            let rating = '';
            if (accuracy >= 90 && aimHits >= 40) rating = 'üèÜ ELITE SNIPER';
            else if (accuracy >= 80 && aimHits >= 30) rating = '‚≠ê SHARPSHOOTER';
            else if (accuracy >= 70 && aimHits >= 20) rating = 'üëç MARKSMAN';
            else if (accuracy >= 60) rating = 'üìà IMPROVING';
            else rating = 'üéÆ KEEP PRACTICING';
            
            resultsContent.innerHTML = `
                <div class="accuracy-ring">${accuracy}%</div>
                <div class="result-item">
                    <span class="result-label">Targets Hit</span>
                    <span class="result-value">${aimHits}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Misses</span>
                    <span class="result-value ${aimMisses > aimHits ? 'danger' : ''}">${aimMisses}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Accuracy</span>
                    <span class="result-value">${accuracy}%</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Rating</span>
                    <span class="result-value">${rating}</span>
                </div>
            `;
            
            document.getElementById('results-overlay').classList.add('show');
        }

        function resetAimGame() {
            aimOverlay.classList.remove('hidden');
            aimTimerEl.textContent = '30s';
            aimHitsEl.textContent = '0';
            aimMissesEl.textContent = '0';
            aimAccuracyEl.textContent = '0%';
            aimProgressEl.style.width = '100%';
        }

        // ============ TILE FRENZY ============
        let frenzyGameActive = false;
        let frenzyStartTime = null;
        let frenzyTimerInterval = null;
        let frenzyScore = 0;
        let frenzyCombo = 1;
        let frenzyBestCombo = 1;
        let frenzyLastHitTime = null;
        let activeTiles = new Set();
        const FRENZY_DURATION = 30000;
        const TILES_COUNT = 4;
        const COMBO_TIMEOUT = 800; // ms to keep combo

        const frenzyContainer = document.getElementById('frenzy-container');
        const frenzyGrid = document.getElementById('frenzy-grid');
        const frenzyOverlay = document.getElementById('frenzy-overlay');
        const frenzyTimerEl = document.getElementById('frenzy-timer');
        const frenzyScoreEl = document.getElementById('frenzy-score');
        const frenzyComboEl = document.getElementById('frenzy-combo');
        const frenzyBestEl = document.getElementById('frenzy-best');
        const frenzyProgressEl = document.getElementById('frenzy-progress');
        const frenzyCells = document.querySelectorAll('.frenzy-cell');

        function startFrenzyGame() {
            frenzyGameActive = true;
            frenzyStartTime = Date.now();
            frenzyScore = 0;
            frenzyCombo = 1;
            frenzyBestCombo = 1;
            frenzyLastHitTime = null;
            activeTiles.clear();
            
            frenzyOverlay.classList.add('hidden');
            updateFrenzyStats();
            
            // Spawn initial tiles
            spawnFrenzyTiles();
            
            // Setup cell click handlers (use mousedown for more reliable detection)
            frenzyCells.forEach(cell => {
                cell.addEventListener('mousedown', handleFrenzyClick);
            });
            
            frenzyTimerInterval = setInterval(() => {
                const elapsed = Date.now() - frenzyStartTime;
                const remaining = Math.max(0, FRENZY_DURATION - elapsed);
                const seconds = Math.ceil(remaining / 1000);
                
                frenzyTimerEl.textContent = seconds + 's';
                frenzyProgressEl.style.width = ((remaining / FRENZY_DURATION) * 100) + '%';
                
                // Check combo timeout
                if (frenzyLastHitTime && Date.now() - frenzyLastHitTime > COMBO_TIMEOUT) {
                    frenzyCombo = 1;
                    updateFrenzyStats();
                }
                
                if (remaining <= 0) {
                    endFrenzyGame();
                }
            }, 100);
        }

        function spawnFrenzyTiles() {
            if (!frenzyGameActive) return;
            
            // Get empty cells
            const emptyCells = [];
            frenzyCells.forEach((cell, index) => {
                if (!activeTiles.has(index)) {
                    emptyCells.push(index);
                }
            });
            
            // Spawn tiles until we have TILES_COUNT active
            while (activeTiles.size < TILES_COUNT && emptyCells.length > 0) {
                const randomIndex = Math.floor(Math.random() * emptyCells.length);
                const cellIndex = emptyCells.splice(randomIndex, 1)[0];
                
                activeTiles.add(cellIndex);
                const cell = frenzyCells[cellIndex];
                cell.classList.add('active');
                
                // Add logo image
                const img = document.createElement('img');
                img.src = 'frid.png';
                img.className = 'frenzy-target';
                img.draggable = false;
                cell.appendChild(img);
            }
        }

        function handleFrenzyClick(e) {
            e.preventDefault();
            if (!frenzyGameActive) return;
            
            const cell = e.currentTarget;
            const index = parseInt(cell.dataset.index);
            
            // Miss - clicked empty cell
            if (!activeTiles.has(index)) {
                frenzyCombo = 1;
                updateFrenzyStats();
                
                // Visual feedback for miss
                cell.style.background = 'rgba(231, 76, 60, 0.3)';
                setTimeout(() => {
                    cell.style.background = '';
                }, 200);
                return;
            }
            
            if (activeTiles.has(index)) {
                // Hit!
                const now = Date.now();
                
                // Update combo
                if (frenzyLastHitTime && now - frenzyLastHitTime < COMBO_TIMEOUT) {
                    frenzyCombo++;
                    if (frenzyCombo > frenzyBestCombo) {
                        frenzyBestCombo = frenzyCombo;
                    }
                    
                    // Show combo popup for big combos
                    if (frenzyCombo >= 3 && frenzyCombo % 2 === 1) {
                        showComboPopup(cell, frenzyCombo);
                    }
                } else {
                    frenzyCombo = 1;
                }
                
                frenzyLastHitTime = now;
                
                // Add score with combo multiplier
                frenzyScore += 10 * frenzyCombo;
                
                // Remove tile
                activeTiles.delete(index);
                cell.classList.remove('active');
                cell.classList.add('hit');
                cell.innerHTML = '';
                
                setTimeout(() => {
                    cell.classList.remove('hit');
                }, 300);
                
                updateFrenzyStats();
                
                // Spawn new tile
                setTimeout(() => spawnFrenzyTiles(), 50);
            }
        }

        function showComboPopup(cell, combo) {
            const popup = document.createElement('div');
            popup.className = 'combo-popup';
            popup.textContent = `x${combo}!`;
            
            const rect = cell.getBoundingClientRect();
            const containerRect = frenzyContainer.getBoundingClientRect();
            
            popup.style.left = (rect.left - containerRect.left + rect.width / 2 - 30) + 'px';
            popup.style.top = (rect.top - containerRect.top) + 'px';
            
            frenzyContainer.appendChild(popup);
            
            setTimeout(() => popup.remove(), 800);
        }

        function updateFrenzyStats() {
            frenzyScoreEl.textContent = frenzyScore;
            frenzyComboEl.textContent = 'x' + frenzyCombo;
            frenzyBestEl.textContent = 'x' + frenzyBestCombo;
            
            // Color combo based on value
            if (frenzyCombo >= 5) {
                frenzyComboEl.style.color = 'var(--warning)';
            } else if (frenzyCombo >= 3) {
                frenzyComboEl.style.color = 'var(--success)';
            } else {
                frenzyComboEl.style.color = 'var(--primary-light)';
            }
        }

        function endFrenzyGame() {
            frenzyGameActive = false;
            clearInterval(frenzyTimerInterval);
            
            // Clear all tiles
            frenzyCells.forEach(cell => {
                cell.classList.remove('active');
                cell.innerHTML = '';
                cell.removeEventListener('mousedown', handleFrenzyClick);
            });
            activeTiles.clear();
            
            const modal = document.getElementById('results-modal');
            const resultsContent = document.getElementById('results-content');
            const resultsTitle = document.getElementById('results-title');
            
            modal.classList.remove('cheater');
            resultsTitle.textContent = '‚ö° Frenzy Complete!';
            
            let rating = '';
            if (frenzyScore >= 2000) rating = 'üî• FRENZY MASTER';
            else if (frenzyScore >= 1500) rating = '‚ö° LIGHTNING FAST';
            else if (frenzyScore >= 1000) rating = 'üåü TILE CRUSHER';
            else if (frenzyScore >= 500) rating = 'üëç Legg opp';
            else rating = 'üéÆ KEEP CLICKING';
            
            resultsContent.innerHTML = `
                <div class="accuracy-ring">${frenzyScore}</div>
                <div class="result-item">
                    <span class="result-label">Final Score</span>
                    <span class="result-value">${frenzyScore}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Best Combo</span>
                    <span class="result-value">x${frenzyBestCombo}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Avg Points/Sec</span>
                    <span class="result-value">${Math.round(frenzyScore / 30)}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Rating</span>
                    <span class="result-value">${rating}</span>
                </div>
            `;
            
            document.getElementById('results-overlay').classList.add('show');
        }

        function resetFrenzyGame() {
            frenzyOverlay.classList.remove('hidden');
            frenzyTimerEl.textContent = '30s';
            frenzyScoreEl.textContent = '0';
            frenzyComboEl.textContent = 'x1';
            frenzyComboEl.style.color = 'var(--primary-light)';
            frenzyBestEl.textContent = 'x1';
            frenzyProgressEl.style.width = '100%';
            
            // Clear any remaining tiles
            frenzyCells.forEach(cell => {
                cell.classList.remove('active');
                cell.innerHTML = '';
            });
            activeTiles.clear();
        }

        // ============ CISCO CLI GAME ============
        const ciscoTasks = [
            {
                id: 1,
                title: "Enter Privileged EXEC Mode",
                description: "You're connected to a router in user EXEC mode. Enter privileged EXEC mode to access administrative commands.",
                difficulty: "easy",
                startPrompt: "Router>",
                commands: [
                    { input: "enable", output: "", newPrompt: "Router#" }
                ],
                hint: "Use the 'enable' command to enter privileged mode"
            },
            {
                id: 2,
                title: "Enter Global Configuration Mode",
                description: "You're in privileged EXEC mode. Enter global configuration mode to make system-wide changes.",
                difficulty: "easy",
                startPrompt: "Router#",
                commands: [
                    { input: ["configure terminal", "conf t"], output: "Enter configuration commands, one per line. End with CNTL/Z.", newPrompt: "Router(config)#" }
                ],
                hint: "Use 'configure terminal' or 'conf t' to enter global config mode"
            },
            {
                id: 3,
                title: "Set the Hostname",
                description: "You're in global configuration mode. Set the router's hostname to 'CoreRouter'.",
                difficulty: "medium",
                startPrompt: "Router(config)#",
                commands: [
                    { input: "hostname CoreRouter", output: "", newPrompt: "CoreRouter(config)#" }
                ],
                hint: "Use 'hostname <name>' to set the device name"
            },
            {
                id: 4,
                title: "Create and Name a VLAN",
                description: "You're on a switch in global configuration mode. Create VLAN 100 and name it 'Sales'.",
                difficulty: "medium",
                startPrompt: "Switch(config)#",
                commands: [
                    { input: "vlan 100", output: "", newPrompt: "Switch(config-vlan)#" },
                    { input: "name Sales", output: "", newPrompt: "Switch(config-vlan)#" }
                ],
                hint: "First create the VLAN with 'vlan <number>', then use 'name <name>'"
            },
            {
                id: 5,
                title: "Configure Interface IP Address",
                description: "Configure interface GigabitEthernet0/1 with IP address 192.168.1.1 and subnet mask 255.255.255.0, then enable the interface.",
                difficulty: "hard",
                startPrompt: "Router(config)#",
                commands: [
                    { input: ["interface gigabitethernet0/1", "interface GigabitEthernet0/1", "int g0/1", "interface g0/1", "int gigabitethernet0/1"], output: "", newPrompt: "Router(config-if)#" },
                    { input: "ip address 192.168.1.1 255.255.255.0", output: "", newPrompt: "Router(config-if)#" },
                    { input: "no shutdown", output: "%LINK-5-CHANGED: Interface GigabitEthernet0/1, changed state to up", newPrompt: "Router(config-if)#" }
                ],
                hint: "Enter the interface, set IP with 'ip address <ip> <mask>', then enable with 'no shutdown'"
            }
        ];

        let ciscoGameActive = false;
        let ciscoStartTime = null;
        let ciscoTimerInterval = null;
        let currentTask = 0;
        let currentCommandIndex = 0;
        let taskTimes = [];
        let totalErrors = 0;
        let answerRevealTimeout = null;

        const ciscoInput = document.getElementById('cisco-input');
        const ciscoTimerEl = document.getElementById('cisco-timer');
        const ciscoTaskNumEl = document.getElementById('cisco-task-num');
        const ciscoDifficultyEl = document.getElementById('cisco-difficulty');
        const ciscoTitleEl = document.getElementById('cisco-title');
        const ciscoDescEl = document.getElementById('cisco-description');
        const terminalPrompt = document.getElementById('terminal-prompt');
        const terminalOutput = document.getElementById('terminal-output');
        const ciscoHint = document.getElementById('cisco-hint');
        const ciscoStartBtn = document.getElementById('cisco-start-btn');
        const answerReveal = document.getElementById('cisco-answer-reveal');
        const answerBox = document.getElementById('answer-box');
        const answerCommands = document.getElementById('answer-commands');
        const infoBtn = document.getElementById('info-btn');

        function startCiscoGame() {
            ciscoGameActive = true;
            ciscoStartTime = Date.now();
            currentTask = 0;
            currentCommandIndex = 0;
            taskTimes = [];
            totalErrors = 0;
            
            ciscoStartBtn.style.display = 'none';
            ciscoInput.disabled = false;
            ciscoInput.focus();
            
            loadCiscoTask();
            
            ciscoTimerInterval = setInterval(() => {
                const elapsed = (Date.now() - ciscoStartTime) / 1000;
                ciscoTimerEl.textContent = elapsed.toFixed(1) + 's';
            }, 100);
        }

        function loadCiscoTask() {
            const task = ciscoTasks[currentTask];
            
            ciscoTaskNumEl.textContent = `${currentTask + 1}/5`;
            ciscoTitleEl.textContent = task.title;
            ciscoDescEl.textContent = task.description;
            
            // Set difficulty badge
            ciscoDifficultyEl.innerHTML = `<span class="difficulty-badge ${task.difficulty}">${task.difficulty.toUpperCase()}</span>`;
            
            // Reset terminal
            terminalOutput.innerHTML = '<div class="line system">--- New Task ---</div>';
            terminalPrompt.textContent = task.startPrompt;
            currentCommandIndex = 0;
            
            // Hide hint
            ciscoHint.classList.remove('show');
            
            // Hide and reset answer reveal
            answerReveal.classList.remove('show');
            answerBox.classList.remove('show');
            infoBtn.classList.remove('clicked');
            
            // Clear any existing timeout
            if (answerRevealTimeout) {
                clearTimeout(answerRevealTimeout);
            }
            
            // Populate answer commands
            const commandsHtml = task.commands.map(cmd => {
                const cmdText = Array.isArray(cmd.input) ? cmd.input[0] : cmd.input;
                return `<code>${cmdText}</code>`;
            }).join('');
            answerCommands.innerHTML = commandsHtml;
            
            // Show info button after 10 seconds
            answerRevealTimeout = setTimeout(() => {
                if (ciscoGameActive && currentTask < ciscoTasks.length) {
                    answerReveal.classList.add('show');
                }
            }, 10000);
            
            ciscoInput.value = '';
            ciscoInput.focus();
        }
        
        function revealAnswer() {
            infoBtn.classList.add('clicked');
            answerBox.classList.toggle('show');
        }

        ciscoInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && ciscoGameActive) {
                e.preventDefault();
                processCiscoCommand();
            }
        });

        // Prevent paste in cisco input
        ciscoInput.addEventListener('paste', (e) => e.preventDefault());
        ciscoInput.addEventListener('drop', (e) => e.preventDefault());

        function processCiscoCommand() {
            const input = ciscoInput.value.trim().toLowerCase();
            const task = ciscoTasks[currentTask];
            const expectedCommand = task.commands[currentCommandIndex];
            
            // Check if input matches expected (can be array of valid inputs)
            const validInputs = Array.isArray(expectedCommand.input) 
                ? expectedCommand.input.map(i => i.toLowerCase())
                : [expectedCommand.input.toLowerCase()];
            
            const isCorrect = validInputs.includes(input);
            
            // Add command to output
            const cmdLine = document.createElement('div');
            cmdLine.className = 'line command';
            cmdLine.textContent = terminalPrompt.textContent + ' ' + ciscoInput.value;
            terminalOutput.appendChild(cmdLine);
            
            if (isCorrect) {
                // Success
                if (expectedCommand.output) {
                    const outputLine = document.createElement('div');
                    outputLine.className = 'line success';
                    outputLine.textContent = expectedCommand.output;
                    terminalOutput.appendChild(outputLine);
                }
                
                terminalPrompt.textContent = expectedCommand.newPrompt;
                currentCommandIndex++;
                ciscoHint.classList.remove('show');
                
                // Check if task complete
                if (currentCommandIndex >= task.commands.length) {
                    const taskTime = (Date.now() - ciscoStartTime) / 1000;
                    taskTimes.push(taskTime);
                    
                    const successLine = document.createElement('div');
                    successLine.className = 'line success';
                    successLine.textContent = '‚úì Task completed!';
                    terminalOutput.appendChild(successLine);
                    
                    currentTask++;
                    
                    if (currentTask >= ciscoTasks.length) {
                        // All tasks complete
                        setTimeout(() => endCiscoGame(), 1000);
                    } else {
                        // Load next task
                        setTimeout(() => {
                            ciscoStartTime = Date.now(); // Reset timer for next task
                            loadCiscoTask();
                        }, 1500);
                    }
                }
            } else {
                // Error
                totalErrors++;
                const errorLine = document.createElement('div');
                errorLine.className = 'line error';
                errorLine.textContent = '% Invalid input detected. Try again.';
                terminalOutput.appendChild(errorLine);
                
                // Show hint after 2 errors on same command
                if (totalErrors % 2 === 0) {
                    ciscoHint.textContent = 'üí° Hint: ' + task.hint;
                    ciscoHint.classList.add('show');
                }
            }
            
            ciscoInput.value = '';
            
            // Scroll terminal to bottom
            const terminalBody = document.getElementById('terminal-body');
            terminalBody.scrollTop = terminalBody.scrollHeight;
        }

        function endCiscoGame() {
            ciscoGameActive = false;
            clearInterval(ciscoTimerInterval);
            ciscoInput.disabled = true;
            
            // Clear answer reveal timeout
            if (answerRevealTimeout) {
                clearTimeout(answerRevealTimeout);
                answerRevealTimeout = null;
            }
            
            const totalTime = taskTimes.reduce((a, b) => a + b, 0);
            const avgTime = totalTime / taskTimes.length;
            
            const modal = document.getElementById('results-modal');
            const resultsContent = document.getElementById('results-content');
            const resultsTitle = document.getElementById('results-title');
            
            modal.classList.remove('cheater');
            resultsTitle.textContent = 'üíª CLI Challenge Complete!';
            
            let rating = '';
            if (totalTime < 30 && totalErrors < 3) rating = 'üèÜ NETWORK ENGINEER';
            else if (totalTime < 45 && totalErrors < 5) rating = '‚≠ê CCNA READY';
            else if (totalTime < 60) rating = 'üëç LEARNING FAST';
            else if (totalTime < 90) rating = 'üìö KEEP STUDYING';
            else rating = 'üéÆ PRACTICE MORE';
            
            let taskBreakdown = taskTimes.map((time, i) => 
                `<div class="result-item">
                    <span class="result-label">Task ${i + 1} (${ciscoTasks[i].difficulty})</span>
                    <span class="result-value">${time.toFixed(1)}s</span>
                </div>`
            ).join('');
            
            resultsContent.innerHTML = `
                <div class="accuracy-ring">${totalTime.toFixed(1)}s</div>
                ${taskBreakdown}
                <div class="result-item">
                    <span class="result-label">Total Errors</span>
                    <span class="result-value ${totalErrors > 5 ? 'danger' : ''}">${totalErrors}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Rating</span>
                    <span class="result-value">${rating}</span>
                </div>
            `;
            
            document.getElementById('results-overlay').classList.add('show');
        }

        function resetCiscoGame() {
            ciscoStartBtn.style.display = 'inline-block';
            ciscoTimerEl.textContent = '0.0s';
            ciscoTaskNumEl.textContent = '1/5';
            ciscoDifficultyEl.innerHTML = '<span class="difficulty-badge easy">EASY</span>';
            ciscoTitleEl.textContent = 'Welcome to Cisco CLI Challenge!';
            ciscoDescEl.textContent = 'Test your networking skills with 5 challenges from easy to hard. Type the correct Cisco IOS commands to complete each task.';
            terminalOutput.innerHTML = '';
            terminalPrompt.textContent = 'Router>';
            ciscoInput.value = '';
            ciscoInput.disabled = true;
            ciscoHint.classList.remove('show');
            
            // Hide answer reveal
            answerReveal.classList.remove('show');
            answerBox.classList.remove('show');
            infoBtn.classList.remove('clicked');
            if (answerRevealTimeout) {
                clearTimeout(answerRevealTimeout);
                answerRevealTimeout = null;
            }
        }

        // ============ CISCO MATCH GAME ============
        const matchPairs = [
            { command: 'copy running-config startup-config', mode: 'R1#', modeLabel: 'Privileged EXEC' },
            { command: 'enable', mode: 'R1>', modeLabel: 'User EXEC' },
            { command: 'login', mode: 'R1(config-line)#', modeLabel: 'Line Config' },
            { command: 'service password-encryption', mode: 'R1(config)#', modeLabel: 'Global Config' },
            { command: 'ip address 192.168.4.4 255.255.255.0', mode: 'R1(config-if)#', modeLabel: 'Interface Config' },
            { command: 'switchport mode access', mode: 'S1(config-if)#', modeLabel: 'Switch Interface' }
        ];

        let matchGameActive = false;
        let matchStartTime = null;
        let matchTimerInterval = null;
        let matchedCount = 0;
        let matchErrors = 0;
        let selectedCommand = null;
        let selectedMode = null;
        let matchConnections = [];
        let shuffledCommands = [];
        let shuffledModes = [];

        const matchTimerEl = document.getElementById('match-timer');
        const matchCountEl = document.getElementById('match-count');
        const matchErrorsEl = document.getElementById('match-errors');
        const matchCommandsEl = document.getElementById('match-commands');
        const matchModesEl = document.getElementById('match-modes');
        const matchOverlay = document.getElementById('match-overlay');
        const matchSvg = document.getElementById('match-svg');

        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function startMatchGame() {
            matchGameActive = true;
            matchStartTime = Date.now();
            matchedCount = 0;
            matchErrors = 0;
            selectedCommand = null;
            selectedMode = null;
            matchConnections = [];

            matchOverlay.classList.add('hidden');
            
            // Shuffle both arrays independently
            shuffledCommands = shuffleArray(matchPairs.map((p, i) => ({ ...p, originalIndex: i })));
            shuffledModes = shuffleArray(matchPairs.map((p, i) => ({ ...p, originalIndex: i })));
            
            renderMatchGame();
            
            matchTimerInterval = setInterval(() => {
                const elapsed = (Date.now() - matchStartTime) / 1000;
                matchTimerEl.textContent = elapsed.toFixed(1) + 's';
            }, 100);
        }

        function renderMatchGame() {
            // Render commands
            matchCommandsEl.innerHTML = shuffledCommands.map((item, index) => {
                const letter = String.fromCharCode(65 + index);
                const matched = matchConnections.some(c => c.commandIndex === item.originalIndex);
                return `
                    <div class="match-item ${matched ? 'matched' : ''} ${selectedCommand === index ? 'selected' : ''}" 
                         data-type="command" data-index="${index}" data-original="${item.originalIndex}"
                         onclick="selectMatchItem('command', ${index})">
                        <span class="match-letter">${letter}</span>
                        ${item.command}
                        ${matched ? '<span class="match-check">‚úì</span>' : ''}
                    </div>
                `;
            }).join('');

            // Render modes
            matchModesEl.innerHTML = shuffledModes.map((item, index) => {
                const letter = String.fromCharCode(65 + index);
                const matched = matchConnections.some(c => c.modeIndex === item.originalIndex);
                return `
                    <div class="match-item ${matched ? 'matched' : ''} ${selectedMode === index ? 'selected' : ''}" 
                         data-type="mode" data-index="${index}" data-original="${item.originalIndex}"
                         onclick="selectMatchItem('mode', ${index})">
                        <span class="match-letter">${letter}</span>
                        <div>
                            <div style="color: var(--success); font-weight: 600;">${item.mode}</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 3px;">${item.modeLabel}</div>
                        </div>
                        ${matched ? '<span class="match-check">‚úì</span>' : ''}
                    </div>
                `;
            }).join('');

            updateMatchStats();
            drawMatchLines();
        }

        function selectMatchItem(type, index) {
            if (!matchGameActive) return;

            const items = type === 'command' ? shuffledCommands : shuffledModes;
            const originalIndex = items[index].originalIndex;
            
            // Check if already matched
            if (type === 'command' && matchConnections.some(c => c.commandIndex === originalIndex)) return;
            if (type === 'mode' && matchConnections.some(c => c.modeIndex === originalIndex)) return;

            if (type === 'command') {
                selectedCommand = selectedCommand === index ? null : index;
            } else {
                selectedMode = selectedMode === index ? null : index;
            }

            // Check if both selected
            if (selectedCommand !== null && selectedMode !== null) {
                checkMatch();
            } else {
                renderMatchGame();
            }
        }

        function checkMatch() {
            const commandOriginal = shuffledCommands[selectedCommand].originalIndex;
            const modeOriginal = shuffledModes[selectedMode].originalIndex;

            if (commandOriginal === modeOriginal) {
                // Correct match!
                matchConnections.push({
                    commandIndex: commandOriginal,
                    modeIndex: modeOriginal,
                    commandDisplayIndex: selectedCommand,
                    modeDisplayIndex: selectedMode
                });
                matchedCount++;

                selectedCommand = null;
                selectedMode = null;

                renderMatchGame();

                // Check if all matched
                if (matchedCount >= matchPairs.length) {
                    setTimeout(() => endMatchGame(), 500);
                }
            } else {
                // Wrong match
                matchErrors++;
                
                // Show error animation
                const commandEl = matchCommandsEl.children[selectedCommand];
                const modeEl = matchModesEl.children[selectedMode];
                
                commandEl.classList.add('error');
                modeEl.classList.add('error');
                
                setTimeout(() => {
                    commandEl.classList.remove('error');
                    modeEl.classList.remove('error');
                    selectedCommand = null;
                    selectedMode = null;
                    renderMatchGame();
                }, 500);

                updateMatchStats();
            }
        }

        function drawMatchLines() {
            matchSvg.innerHTML = '';
            
            matchConnections.forEach(conn => {
                const commandEl = matchCommandsEl.querySelector(`[data-original="${conn.commandIndex}"]`);
                const modeEl = matchModesEl.querySelector(`[data-original="${conn.modeIndex}"]`);
                
                if (commandEl && modeEl) {
                    const containerRect = document.getElementById('match-container').getBoundingClientRect();
                    const cmdRect = commandEl.getBoundingClientRect();
                    const modeRect = modeEl.getBoundingClientRect();
                    
                    const x1 = cmdRect.right - containerRect.left;
                    const y1 = cmdRect.top + cmdRect.height / 2 - containerRect.top;
                    const x2 = modeRect.left - containerRect.left;
                    const y2 = modeRect.top + modeRect.height / 2 - containerRect.top;
                    
                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    line.setAttribute('x1', x1);
                    line.setAttribute('y1', y1);
                    line.setAttribute('x2', x2);
                    line.setAttribute('y2', y2);
                    matchSvg.appendChild(line);
                }
            });
        }

        function updateMatchStats() {
            matchCountEl.textContent = `${matchedCount}/${matchPairs.length}`;
            matchErrorsEl.textContent = matchErrors;
            
            if (matchErrors >= 3) {
                matchErrorsEl.style.color = 'var(--danger)';
            } else {
                matchErrorsEl.style.color = 'var(--primary-light)';
            }
        }

        function endMatchGame() {
            matchGameActive = false;
            clearInterval(matchTimerInterval);

            const totalTime = (Date.now() - matchStartTime) / 1000;

            const modal = document.getElementById('results-modal');
            const resultsContent = document.getElementById('results-content');
            const resultsTitle = document.getElementById('results-title');

            modal.classList.remove('cheater');
            resultsTitle.textContent = 'üîó Matching Complete!';

            let rating = '';
            if (totalTime < 10 && matchErrors === 0) rating = 'üèÜ CISCO MASTER';
            else if (totalTime < 15 && matchErrors <= 1) rating = '‚≠ê NETWORK PRO';
            else if (totalTime < 20 && matchErrors <= 2) rating = 'üëç WELL DONE';
            else if (totalTime < 30) rating = 'üìö KEEP LEARNING';
            else rating = 'üéÆ PRACTICE MORE';

            const accuracy = Math.round((matchPairs.length / (matchPairs.length + matchErrors)) * 100);

            resultsContent.innerHTML = `
                <div class="accuracy-ring">${accuracy}%</div>
                <div class="result-item">
                    <span class="result-label">Total Time</span>
                    <span class="result-value">${totalTime.toFixed(2)}s</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Correct Matches</span>
                    <span class="result-value">${matchPairs.length}/${matchPairs.length}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Errors</span>
                    <span class="result-value ${matchErrors > 2 ? 'danger' : ''}">${matchErrors}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Rating</span>
                    <span class="result-value">${rating}</span>
                </div>
            `;

            document.getElementById('results-overlay').classList.add('show');
        }

        function resetMatchGame() {
            matchTimerEl.textContent = '0.0s';
            matchCountEl.textContent = '0/6';
            matchErrorsEl.textContent = '0';
            matchErrorsEl.style.color = 'var(--primary-light)';
            matchOverlay.classList.remove('hidden');
            matchCommandsEl.innerHTML = '';
            matchModesEl.innerHTML = '';
            matchSvg.innerHTML = '';
        }

        // Redraw lines on window resize
        window.addEventListener('resize', () => {
            if (matchGameActive) {
                drawMatchLines();
            }
        });

        // ============ WINDOWS SETUP GAME ============
        const windowsScreens = [
            {
                id: 'region',
                title: 'Is this the right country or region?',
                subtitle: 'Select your country or region',
                type: 'select',
                options: [
                    { id: 'us', title: 'United States' },
                    { id: 'uk', title: 'United Kingdom' },
                    { id: 'dk', title: 'Denmark' },
                    { id: 'de', title: 'Germany' },
                    { id: 'fr', title: 'France' },
                    { id: 'nl', title: 'Netherlands' }
                ],
                nextBtn: 'Yes'
            },
            {
                id: 'keyboard',
                title: 'Is this the right keyboard layout?',
                subtitle: 'Select your keyboard layout',
                type: 'select',
                options: [
                    { id: 'us', title: 'US' },
                    { id: 'uk', title: 'United Kingdom' },
                    { id: 'dk', title: 'Danish' },
                    { id: 'de', title: 'German' }
                ],
                nextBtn: 'Yes'
            },
            {
                id: 'keyboard2',
                title: 'Want to add a second keyboard layout?',
                subtitle: 'You can add another keyboard layout if you use multiple languages',
                type: 'choice',
                nextBtn: 'Skip'
            },
            {
                id: 'network',
                title: "Let's connect you to a network",
                subtitle: '',
                type: 'network',
                networks: [
                    { id: 'frid-corp', name: 'FRID-Corporate', secured: true, signal: 3 },
                    { id: 'frid-guest', name: 'FRID-Guest', secured: true, signal: 2 },
                    { id: 'frid-iot', name: 'FRID-IoT', secured: true, signal: 3 },
                    { id: 'frid-5g', name: 'FRID-5G', secured: true, signal: 1 }
                ],
                nextBtn: 'Connect'
            },
            {
                id: 'license',
                title: 'License Agreement',
                subtitle: 'Please review the Microsoft Software License Terms',
                type: 'license',
                nextBtn: 'Accept'
            },
            {
                id: 'name',
                title: "Let's name your device",
                subtitle: 'Make it yours with a unique name',
                type: 'input',
                placeholder: 'Enter device name',
                nextBtn: 'Next'
            },
            {
                id: 'account',
                title: 'How would you like to set up this device?',
                subtitle: 'Choose your account type',
                type: 'account',
                options: [
                    { id: 'personal', title: 'Set up for personal use', subtitle: 'Use your Microsoft account' },
                    { id: 'work', title: 'Set up for work or school', subtitle: 'Join your organization\'s network' }
                ],
                nextBtn: 'Next'
            },
            {
                id: 'privacy',
                title: 'Choose privacy settings',
                subtitle: 'Review and customize your privacy preferences',
                type: 'privacy',
                settings: [
                    { id: 'location', title: 'Location', desc: 'Let apps use your location' },
                    { id: 'diagnostic', title: 'Diagnostic data', desc: 'Send optional data to Microsoft' },
                    { id: 'inking', title: 'Inking & typing', desc: 'Improve inking and typing recognition' },
                    { id: 'tailored', title: 'Tailored experiences', desc: 'Get tips and recommendations' },
                    { id: 'advertising', title: 'Advertising ID', desc: 'Get personalized ads' }
                ],
                nextBtn: 'Accept'
            }
        ];

        let windowsGameActive = false;
        let windowsStartTime = null;
        let windowsTimerInterval = null;
        let windowsCurrentScreen = 0;
        let windowsFocusIndex = 0;
        let windowsSelectedOption = null;
        let windowsDeviceName = '';
        let windowsRequiredNetwork = null;
        let windowsNetworkError = false;

        const windowsScreen = document.getElementById('windows-screen');
        const windowsTimerEl = document.getElementById('windows-timer');

        function startWindowsGame() {
            windowsGameActive = true;
            windowsStartTime = Date.now();
            windowsCurrentScreen = 0;
            windowsFocusIndex = 0;
            windowsSelectedOption = null;
            windowsDeviceName = '';
            windowsNetworkError = false;
            
            // Pick a random required network
            const networks = windowsScreens.find(s => s.id === 'network').networks;
            windowsRequiredNetwork = networks[Math.floor(Math.random() * networks.length)].id;
            
            windowsTimerInterval = setInterval(() => {
                const elapsed = (Date.now() - windowsStartTime) / 1000;
                windowsTimerEl.textContent = elapsed.toFixed(1) + 's';
            }, 100);
            
            renderWindowsScreen();
            document.addEventListener('keydown', handleWindowsKeydown);
        }

        function renderWindowsScreen() {
            if (windowsCurrentScreen >= windowsScreens.length) {
                showWindowsComplete();
                return;
            }

            const screen = windowsScreens[windowsCurrentScreen];
            let html = '';

            // Progress dots
            const progressHtml = windowsScreens.map((s, i) => {
                let cls = 'windows-progress-dot';
                if (i < windowsCurrentScreen) cls += ' completed';
                else if (i === windowsCurrentScreen) cls += ' active';
                return `<div class="${cls}"></div>`;
            }).join('');

            // Get subtitle - special case for network
            let subtitle = screen.subtitle;
            if (screen.type === 'network') {
                const requiredNet = screen.networks.find(n => n.id === windowsRequiredNetwork);
                subtitle = `Connect to: <strong style="color: #0078d4;">${requiredNet.name}</strong>`;
            }

            html += `<div class="windows-header">
                <h2>${screen.title}</h2>
                <p>${subtitle}</p>
            </div>`;

            html += `<div class="windows-content">`;

            if (screen.type === 'select') {
                html += `<div class="windows-options">`;
                screen.options.forEach((opt, i) => {
                    const selected = windowsSelectedOption === opt.id;
                    const focused = windowsFocusIndex === i;
                    html += `<div class="windows-option ${selected ? 'selected' : ''} ${focused ? 'focused' : ''}" 
                                 data-option="${opt.id}" onclick="selectWindowsOption('${opt.id}')">
                        <div class="option-title">${opt.title}</div>
                    </div>`;
                });
                html += `</div>`;
            } else if (screen.type === 'choice') {
                html += `<p style="color: #666; margin-bottom: 20px;">Most users skip this step.</p>`;
            } else if (screen.type === 'network') {
                if (windowsNetworkError) {
                    html += `<div style="background: #fff3cd; border: 1px solid #ffc107; color: #856404; padding: 10px 15px; border-radius: 6px; margin-bottom: 15px;">
                        ‚ö†Ô∏è Wrong network! Please select the correct one.
                    </div>`;
                }
                html += `<div class="windows-options" style="grid-template-columns: 1fr;">`;
                screen.networks.forEach((net, i) => {
                    const focused = windowsFocusIndex === i;
                    const selected = windowsSelectedOption === net.id;
                    const signal = 'üì∂'.repeat(net.signal);
                    html += `<div class="windows-option ${selected ? 'selected' : ''} ${focused ? 'focused' : ''}" 
                                 data-option="${net.id}" onclick="selectWindowsOption('${net.id}')">
                        <div class="option-title">${net.name} ${net.secured ? 'üîí' : ''}</div>
                        <div class="option-subtitle">${signal}</div>
                    </div>`;
                });
                html += `</div>`;
            } else if (screen.type === 'license') {
                html += `<div style="background: white; border: 1px solid #ddd; border-radius: 4px; padding: 15px; height: 150px; overflow-y: auto; font-size: 0.85rem; color: #666; margin-bottom: 15px;">
                    <p><strong>MICROSOFT SOFTWARE LICENSE TERMS</strong></p>
                    <p>WINDOWS OPERATING SYSTEM</p>
                    <p>IF YOU LIVE IN (OR IF YOUR PRINCIPAL PLACE OF BUSINESS IS IN) THE UNITED STATES, PLEASE READ THE BINDING ARBITRATION CLAUSE AND CLASS ACTION WAIVER IN SECTION 11...</p>
                    <p>These license terms are an agreement between you and Microsoft Corporation (or one of its affiliates). They apply to the software named above and any Microsoft services or software updates...</p>
                    <p>By accepting this agreement or using the software, you agree to all of these terms...</p>
                </div>`;
            } else if (screen.type === 'input') {
                html += `<input type="text" class="windows-input" 
                                id="windows-name-input" placeholder="${screen.placeholder}" 
                                value="${windowsDeviceName}" oninput="windowsDeviceName = this.value"
                                onkeydown="if(event.key==='Enter'){event.preventDefault();windowsNext();}">`;
            } else if (screen.type === 'account') {
                html += `<div class="windows-options" style="grid-template-columns: 1fr;">`;
                screen.options.forEach((opt, i) => {
                    const focused = windowsFocusIndex === i;
                    const selected = windowsSelectedOption === opt.id;
                    html += `<div class="windows-option ${selected ? 'selected' : ''} ${focused ? 'focused' : ''}" 
                                 data-option="${opt.id}" onclick="selectWindowsOption('${opt.id}')">
                        <div class="option-title">${opt.title}</div>
                        <div class="option-subtitle">${opt.subtitle}</div>
                    </div>`;
                });
                html += `</div>`;
            } else if (screen.type === 'privacy') {
                html += `<div class="windows-privacy-scroll">`;
                screen.settings.forEach((setting, i) => {
                    const focused = windowsFocusIndex === i;
                    html += `<div class="windows-checkbox ${focused ? 'focused' : ''}" onclick="toggleWindowsCheckbox(${i})">
                        <input type="checkbox" id="priv-${setting.id}">
                        <div class="windows-checkbox-label">
                            <div class="title">${setting.title}</div>
                            <div class="desc">${setting.desc}</div>
                        </div>
                    </div>`;
                });
                html += `</div>`;
            }

            html += `</div>`;

            // Determine if button is focused
            let buttonFocused = false;
            if (screen.type === 'select' || screen.type === 'account') {
                buttonFocused = windowsFocusIndex === screen.options.length;
            } else if (screen.type === 'network') {
                buttonFocused = windowsFocusIndex === screen.networks.length;
            } else if (screen.type === 'privacy') {
                buttonFocused = windowsFocusIndex === screen.settings.length;
            } else {
                buttonFocused = true; // For license, choice, input - button is always "focused"
            }

            // Footer with button
            html += `<div class="windows-footer">
                <div></div>
                <div class="windows-footer-right">
                    <button class="windows-btn primary ${buttonFocused ? 'focused' : ''}" onclick="windowsNext()">${screen.nextBtn}</button>
                </div>
            </div>`;

            html += `<div class="windows-progress">${progressHtml}</div>`;

            windowsScreen.innerHTML = html;

            // Focus input if it's an input screen
            if (screen.type === 'input') {
                setTimeout(() => {
                    const input = document.getElementById('windows-name-input');
                    if (input) input.focus();
                }, 50);
            }
        }

        function selectWindowsOption(optionId) {
            windowsSelectedOption = optionId;
            const screen = windowsScreens[windowsCurrentScreen];
            if (screen.options) {
                windowsFocusIndex = screen.options.findIndex(o => o.id === optionId);
            } else if (screen.networks) {
                windowsFocusIndex = screen.networks.findIndex(n => n.id === optionId);
            }
            windowsNetworkError = false;
            renderWindowsScreen();
        }

        function toggleWindowsCheckbox(index) {
            const checkbox = document.querySelectorAll('.windows-checkbox input[type="checkbox"]')[index];
            if (checkbox) checkbox.checked = !checkbox.checked;
            windowsFocusIndex = index;
        }

        function handleWindowsKeydown(e) {
            if (!windowsGameActive) return;
            
            // Don't intercept if typing in input (except for Tab/Enter)
            const isInInput = document.activeElement.tagName === 'INPUT' && document.activeElement.type === 'text';
            if (isInInput && e.key !== 'Tab' && e.key !== 'Enter') {
                return;
            }

            const screen = windowsScreens[windowsCurrentScreen];
            
            // Get max index for current screen type
            let itemCount = 0;
            if (screen.type === 'select' || screen.type === 'account') {
                itemCount = screen.options.length;
            } else if (screen.type === 'network') {
                itemCount = screen.networks.length;
            } else if (screen.type === 'privacy') {
                itemCount = screen.settings.length;
            }
            
            // Total focusable items = items + 1 (for the button)
            const maxFocusIndex = itemCount; // 0 to itemCount-1 are items, itemCount is the button

            if (e.key === 'Tab') {
                e.preventDefault();
                if (e.shiftKey) {
                    windowsFocusIndex = windowsFocusIndex > 0 ? windowsFocusIndex - 1 : maxFocusIndex;
                } else {
                    windowsFocusIndex = windowsFocusIndex < maxFocusIndex ? windowsFocusIndex + 1 : 0;
                }
                renderWindowsScreen();
            } else if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {
                e.preventDefault();
                if (windowsFocusIndex < maxFocusIndex) {
                    windowsFocusIndex++;
                }
                renderWindowsScreen();
            } else if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
                e.preventDefault();
                if (windowsFocusIndex > 0) {
                    windowsFocusIndex--;
                }
                renderWindowsScreen();
            } else if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                
                // If focused on the button (last index) or on screens without items
                if (windowsFocusIndex === maxFocusIndex || itemCount === 0) {
                    windowsNext();
                    return;
                }
                
                // Otherwise, interact with the focused item
                if (screen.type === 'privacy') {
                    // Toggle checkbox
                    toggleWindowsCheckbox(windowsFocusIndex);
                } else if (screen.type === 'select' || screen.type === 'account') {
                    // Select this option
                    windowsSelectedOption = screen.options[windowsFocusIndex].id;
                    windowsNetworkError = false;
                    renderWindowsScreen();
                } else if (screen.type === 'network') {
                    // Select this network
                    windowsSelectedOption = screen.networks[windowsFocusIndex].id;
                    windowsNetworkError = false;
                    renderWindowsScreen();
                }
            }
        }

        function windowsNext() {
            const screen = windowsScreens[windowsCurrentScreen];

            // Validation for selection screens - must have something selected
            if ((screen.type === 'select' || screen.type === 'account') && !windowsSelectedOption) {
                return; // Can't proceed without selection
            }

            // Validation for network - must select the correct network
            if (screen.type === 'network') {
                if (!windowsSelectedOption) {
                    return; // Must select a network
                }
                if (windowsSelectedOption !== windowsRequiredNetwork) {
                    windowsNetworkError = true;
                    renderWindowsScreen();
                    return;
                }
            }

            // Validation for input screen
            if (screen.type === 'input') {
                windowsDeviceName = document.getElementById('windows-name-input')?.value || windowsDeviceName;
                if (!windowsDeviceName.trim()) {
                    windowsDeviceName = 'FRID-PC';
                }
            }

            // Show loading animation briefly
            windowsScreen.innerHTML = `
                <div class="windows-loading">
                    <div class="windows-spinner"></div>
                    <p>Please wait...</p>
                </div>
            `;

            setTimeout(() => {
                windowsCurrentScreen++;
                windowsFocusIndex = 0;
                windowsSelectedOption = null;
                windowsNetworkError = false;
                renderWindowsScreen();
            }, 300);
        }

        function showWindowsComplete() {
            windowsGameActive = false;
            clearInterval(windowsTimerInterval);
            document.removeEventListener('keydown', handleWindowsKeydown);

            const totalTime = (Date.now() - windowsStartTime) / 1000;

            const modal = document.getElementById('results-modal');
            const resultsContent = document.getElementById('results-content');
            const resultsTitle = document.getElementById('results-title');

            modal.classList.remove('cheater');
            resultsTitle.textContent = 'ü™ü Windows Setup Complete!';

            let rating = '';
            if (totalTime < 20) rating = 'üèÜ PROMPT ENGINEER';
            else if (totalTime < 30) rating = '‚ö° SYSADMIN PRO';
            else if (totalTime < 45) rating = 'üëç TECH SAVVY';
            else if (totalTime < 60) rating = 'üìö SI OPP JOBBEN';
            else rating = 'üêå TAKE YOUR TIME';

            resultsContent.innerHTML = `
                <div class="accuracy-ring">${totalTime.toFixed(1)}s</div>
                <div class="result-item">
                    <span class="result-label">Total Time</span>
                    <span class="result-value">${totalTime.toFixed(2)}s</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Device Name</span>
                    <span class="result-value">${windowsDeviceName || 'FRID-PC'}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Rating</span>
                    <span class="result-value">${rating}</span>
                </div>
            `;

            document.getElementById('results-overlay').classList.add('show');
        }

        function resetWindowsGame() {
            windowsTimerEl.textContent = '0.0s';
            windowsScreen.innerHTML = `
                <div class="windows-welcome">
                    <div class="windows-logo">ü™ü</div>
                    <h2>Windows 11 Setup Speedrun</h2>
                    <p>Navigate through the Windows setup as fast as possible!</p>
                    <p class="windows-controls">Use <kbd>Tab</kbd> <kbd>Enter</kbd> <kbd>‚Üë</kbd> <kbd>‚Üì</kbd> or Mouse</p>
                    <button class="windows-btn primary" onclick="startWindowsGame()">Start Setup</button>
                </div>
            `;
            document.removeEventListener('keydown', handleWindowsKeydown);
        }

        // ============ KEYBOARD SHORTCUTS ============
        document.addEventListener('keydown', (e) => {
            // Press R to restart aim-based games
            if (e.key.toLowerCase() === 'r' && !e.ctrlKey && !e.altKey && !e.metaKey) {
                // Don't trigger if typing in an input
                if (document.activeElement.tagName === 'INPUT') return;
                
                // Check if Aim Trainer is active and game is running
                if (document.getElementById('aim-section').classList.contains('active') && aimGameActive) {
                    // Stop game without showing results
                    aimGameActive = false;
                    clearInterval(aimTimerInterval);
                    if (currentTarget) {
                        currentTarget.remove();
                        currentTarget = null;
                    }
                    aimContainer.removeEventListener('click', handleMiss);
                    resetAimGame();
                    startAimGame();
                }
                // Check if Tile Frenzy is active and game is running
                else if (document.getElementById('frenzy-section').classList.contains('active') && frenzyGameActive) {
                    // Stop game without showing results
                    frenzyGameActive = false;
                    clearInterval(frenzyTimerInterval);
                    frenzyCells.forEach(cell => {
                        cell.classList.remove('active');
                        cell.innerHTML = '';
                        cell.removeEventListener('mousedown', handleFrenzyClick);
                    });
                    activeTiles.clear();
                    resetFrenzyGame();
                    startFrenzyGame();
                }
            }
        });

        // ============ TAB SWITCHING ============
        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.game-section').forEach(section => section.classList.remove('active'));
            
            const tabs = document.querySelectorAll('.tab-btn');
            
            if (tab === 'typing') {
                tabs[0].classList.add('active');
                document.getElementById('typing-section').classList.add('active');
                typingInput.focus();
            } else if (tab === 'aim') {
                tabs[1].classList.add('active');
                document.getElementById('aim-section').classList.add('active');
            } else if (tab === 'frenzy') {
                tabs[2].classList.add('active');
                document.getElementById('frenzy-section').classList.add('active');
            } else if (tab === 'cisco') {
                tabs[3].classList.add('active');
                document.getElementById('cisco-section').classList.add('active');
            } else if (tab === 'ciscomatch') {
                tabs[4].classList.add('active');
                document.getElementById('ciscomatch-section').classList.add('active');
            } else if (tab === 'windows') {
                tabs[5].classList.add('active');
                document.getElementById('windows-section').classList.add('active');
            }
        }

        function closeResults() {
            document.getElementById('results-overlay').classList.remove('show');
            
            // Reset appropriate game
            if (document.getElementById('typing-section').classList.contains('active')) {
                resetTypingGame();
            } else if (document.getElementById('aim-section').classList.contains('active')) {
                resetAimGame();
            } else if (document.getElementById('frenzy-section').classList.contains('active')) {
                resetFrenzyGame();
            } else if (document.getElementById('cisco-section').classList.contains('active')) {
                resetCiscoGame();
            } else if (document.getElementById('ciscomatch-section').classList.contains('active')) {
                resetMatchGame();
            } else if (document.getElementById('windows-section').classList.contains('active')) {
                resetWindowsGame();
            }
        }

        // Initialize
        initTypingGame();
    </script>
</body>
</html>

